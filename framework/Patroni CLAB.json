{
  "active": false,
  "connections": {
    "When clicking \"Execute Workflow\"": {
      "main": [
        [
          {
            "node": "OC Login CLAB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Port Forward Crunchy": {
      "main": [
        [
          {
            "node": "Postgres1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Port Forward HELM": {
      "main": [
        [
          {
            "node": "Postgres",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OC Login CLAB": {
      "main": [
        [
          {
            "node": "Set Port Forward HELM",
            "type": "main",
            "index": 0
          },
          {
            "node": "Set Port Forward Crunchy",
            "type": "main",
            "index": 0
          },
          {
            "node": "Set Port Forward Patroni",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Port Forward Patroni": {
      "main": [
        [
          {
            "node": "Postgres2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres2": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Postgres": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Postgres1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "OC Login CLAB1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OC Login CLAB1": {
      "main": [
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2023-02-19T08:37:17.480Z",
  "id": "14",
  "name": "Patroni CLAB",
  "nodes": [
    {
      "parameters": {},
      "id": "61576b2e-b545-4738-adb1-ef7fd48eaf37",
      "name": "When clicking \"Execute Workflow\"",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -200,
        220
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "create table IF NOT EXISTS lat_longs  (   c1 bigint generated always as identity,   c2 float );  \n\ninsert into lat_longs(c2) select random() * 100 from generate_series(1,10e3) as g(id);  commit;  \n\nselect count(*) from lat_longs;\n\nselect * from lat_longs;\n\ndrop table lat_longs;",
        "additionalFields": {}
      },
      "id": "ffb116c2-3044-401d-be77-a8c0b599fa47",
      "name": "Postgres",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        380,
        220
      ],
      "credentials": {
        "postgres": {
          "id": "14",
          "name": "Postgres account 2"
        }
      }
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "create table IF NOT EXISTS lat_longs  (   c1 bigint generated always as identity,   c2 float );  \n\ninsert into lat_longs(c2) select random() * 100 from generate_series(1,10e4) as g(id);  \n\ncommit;  \n\nselect count(*) from lat_longs;\n\nselect * from lat_longs;\n\ndrop table lat_longs;",
        "additionalFields": {}
      },
      "id": "8f16dbe8-cd5d-45d9-8f60-270cfcfecccf",
      "name": "Postgres1",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        380,
        380
      ],
      "credentials": {
        "postgres": {
          "id": "15",
          "name": "Postgres Crunchy"
        }
      }
    },
    {
      "parameters": {
        "command": "nohup oc --namespace e31b6b-dev port-forward service/hippo-pgbouncer 15436:5432 > /dev/null 2>&1 & "
      },
      "id": "4286780a-a7ea-4256-bcca-1a7045c42a0c",
      "name": "Set Port Forward Crunchy",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        160,
        380
      ]
    },
    {
      "parameters": {
        "command": "export PODNAME=$(oc get pods --namespace e31b6b-dev -l \"app.kubernetes.io/name=patroni,app.kubernetes.io/instance=test-patroni-instance\" -o jsonpath=\"{.items[0].metadata.name}\") \n\nexport CONTAINERPORT=$(oc get pod --namespace e31b6b-dev $PODNAME -o jsonpath=\"{.spec.containers[0].ports[0].containerPort}\")  \n\necho $PODNAME\necho $CONTAINERPORT\n\nnohup oc --namespace e31b6b-dev port-forward $PODNAME 8432:$CONTAINER_PORT > /dev/null 2>&1 & "
      },
      "id": "9349cfc2-dddc-4601-9f0e-cd0365476b91",
      "name": "Set Port Forward HELM",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        160,
        220
      ]
    },
    {
      "parameters": {
        "command": "oc login --token=eyJhbGciOiJSUzI1NiIsImtpZCI6IjZrWi1WX0RUSTc5eGljUmlXbzlaUmVRanpNNkRLVE5YcUNQbHZPeEJOUTgifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJlMzFiNmItZGV2Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InJlbW90ZS1leGVjdXRpb24tdG9rZW4tZ210NWYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoicmVtb3RlLWV4ZWN1dGlvbiIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VydmljZS1hY2NvdW50LnVpZCI6IjVhMzUzZDc2LWEzNTMtNDczMC1iZjRhLTlmNGY0ODlmOGFjMiIsInN1YiI6InN5c3RlbTpzZXJ2aWNlYWNjb3VudDplMzFiNmItZGV2OnJlbW90ZS1leGVjdXRpb24ifQ.SnmtR8N_Du6xd6tSk0JyZuvbWK_BP_N5uCwl3cojN9-IIlqGAyXQyp9tYmd0dOwjDnXcyncMZw7Gk9uS_WGggqINjvpQ2RS0Y1wWNxco58pk0IH3tLgltHa6tmBZvV5L5hXGMnHYdiKBEU4Ht7_uhLsG1p7LsYufCkS5_7h0rBH8UltbEJJQqSbXm8hsYt7IUWCXEPEbpo8aGbqOk1ddkM-MTXhPnLK2zfMHsdqZkljY4R_tWraFUWW9U33Ts9cJv-Y3QVDLy0EgbByFAR1dqdslbLJD85TCHqrIJyifQR94sU7RyZLxM0AsmW0KuxuR00cRcvn-jJxsv-hKqdZx7w --server=https://api.clab.devops.gov.bc.ca:6443"
      },
      "id": "e1b672c7-bb08-4d71-b3f5-31ba967d8cb9",
      "name": "OC Login CLAB",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        -20,
        220
      ]
    },
    {
      "parameters": {
        "command": "nohup oc port-forward $(oc -n e31b6b-dev get pods -o name --selector role=master,cluster-name=patroni-reference) 15433:5432 > /dev/null 2>&1 & "
      },
      "id": "c28cbdb8-30fd-4b7e-9172-02f4bd8cd056",
      "name": "Set Port Forward Patroni",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        160,
        60
      ]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "create table IF NOT EXISTS lat_longs  (   c1 bigint generated always as identity,   c2 float );  \n\ninsert into lat_longs(c2) select random() * 100 from generate_series(1,10e3) as g(id);  commit;  \n\nselect count(*) from lat_longs;\n\nselect * from lat_longs;\n\ndrop table lat_longs;",
        "additionalFields": {}
      },
      "id": "a1920eff-62d0-4713-a245-d73ab6c7d6e7",
      "name": "Postgres2",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [
        380,
        60
      ],
      "credentials": {
        "postgres": {
          "id": "13",
          "name": "Patroni (Reference)"
        }
      }
    },
    {
      "parameters": {
        "command": "oc logout"
      },
      "id": "e097f0f5-3adb-4897-8764-d06c0e4b9a77",
      "name": "OC Login CLAB1",
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        760,
        220
      ]
    },
    {
      "parameters": {},
      "id": "af1035db-6156-4ad0-8347-a44936e0908f",
      "name": "Merge",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 2,
      "position": [
        580,
        220
      ]
    },
    {
      "parameters": {},
      "id": "130c3cd7-0fa6-40d1-affd-c7a7461125de",
      "name": "No Operation, do nothing",
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        940,
        220
      ]
    }
  ],
  "pinData": {},
  "settings": {},
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2023-02-20T09:48:35.609Z",
  "versionId": "6c35f3f4-bf12-48f5-b8f8-bc0afa661407"
}